<!doctype html>
<html lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Family Film Journal</title>

  <style>
    :root{
      --bgTop:#ece9f3;
      --bg:#1b1f23;
      --panel:#20262c;
      --text:#e9eef3;
      --muted:#b7c0c9;
      --accent:#19d3c5;   /* teal like your Prime-style award line */
      --brand:#ff8a2a;    /* small underline accent for headings */
      --radius:18px;
      --shadow:0 18px 40px rgba(0,0,0,.45);
      --gap:22px;
      --shelfGap:34px;    /* tighter vertical gap between shelves */
      --cardW: 460px;     /* landscape poster width */
      --cardH: 190px;     /* landscape poster height */
      --peekW: 520px;     /* hover overlay width */
      --peekH: 240px;     /* hover overlay height */
      --peekPad: 18px;
      --edgePad: 56px;    /* left/right page padding */
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        linear-gradient(var(--bgTop) 0 112px, var(--bg) 112px 100%);
    }

    /* Top nav (simple, matches your current aesthetic) */
    header{
      height:112px;
      display:flex;
      align-items:center;
      justify-content:center;
      color:#2a2f35;
    }
    .topnav{
      width:min(1180px, calc(100% - 2*var(--edgePad)));
      display:flex;
      align-items:center;
      justify-content:center;
      gap:34px;
      font-weight:600;
      letter-spacing:.2px;
    }
    .topnav a{
      color:#2a2f35;
      text-decoration:none;
      opacity:.85;
    }
    .topnav a:hover{ opacity:1; text-decoration:underline; }

    main{
      width:min(1180px, calc(100% - 2*var(--edgePad)));
      margin:0 auto;
      padding:26px 0 70px;
    }

    /* Shelf */
    .shelf{ margin:0 0 var(--shelfGap); position:relative; }
    .shelf__head{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      margin:0 0 12px;
    }
    .shelf__title{
      margin:0;
      font-size:24px;
      font-weight:750;
      letter-spacing:.2px;
      position:relative;
      display:inline-block;
      padding-bottom:8px;
    }
    .shelf__title:after{
      content:"";
      position:absolute;
      left:0; bottom:0;
      width:34px; height:3px;
      background:var(--brand);
      border-radius:999px;
      opacity:.85;
    }
    .shelf__seeall{
      color:var(--muted);
      text-decoration:none;
      font-weight:650;
      letter-spacing:.2px;
      padding-bottom:8px;
    }
    .shelf__seeall:hover{ color:var(--text); text-decoration:underline; }

    .shelf__frame{
      position:relative;
      overflow:visible; /* important: allow overlays to overlap next row */
    }

    /* Rail */
    .rail{
      display:flex;
      gap:var(--gap);
      overflow-x:auto;
      overflow-y:visible;
      scroll-behavior:smooth;
      scrollbar-width:none;
      padding: 0 2px;
    }
    .rail::-webkit-scrollbar{ height:0; }

    /* Cards */
    .card{
      position:relative;
      flex:0 0 auto;
      width:var(--cardW);
      user-select:none;
      text-decoration:none;
      color:inherit;
      outline:none;
    }
    .poster{
      width:var(--cardW);
      height:var(--cardH);
      border-radius:var(--radius);
      overflow:hidden;
      position:relative;
      background:#111;
      box-shadow: 0 10px 25px rgba(0,0,0,.35);
    }
    .poster img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }
    .meta{
      margin-top:10px;
      display:flex;
      flex-direction:column;
      gap:3px;
      padding-left:4px;
    }
    .meta .name{
      font-weight:750;
      letter-spacing:.2px;
    }
    .meta .year{
      color:var(--muted);
      font-size:14px;
    }

    /* Nav arrows */
    .navbtn{
      position:absolute;
      top: 62px;
      width:38px; height:38px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(10,12,14,.55);
      color:var(--text);
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      z-index:30;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      transition: transform .12s ease, opacity .12s ease;
      opacity:.0;
      pointer-events:none;
    }
    .shelf__frame.has-overflow .navbtn{
      opacity:.92;
      pointer-events:auto;
    }
    .navbtn:hover{ transform: scale(1.05); }
    .navbtn:active{ transform: scale(.98); }
    .navbtn.prev{ left:-10px; }
    .navbtn.next{ right:-10px; }

    /* Edge peek gradients (only when overflow exists) */
    .fade{
      position:absolute;
      top:-2px;
      bottom:-2px;
      width:56px;
      pointer-events:none;
      z-index:20;
      opacity:0;
      transition: opacity .15s ease;
    }
    .fade.left{
      left:-2px;
      background: linear-gradient(90deg, rgba(27,31,35,1) 0%, rgba(27,31,35,.0) 100%);
    }
    .fade.right{
      right:-2px;
      background: linear-gradient(270deg, rgba(27,31,35,1) 0%, rgba(27,31,35,.0) 100%);
    }
    .shelf__frame.has-overflow.show-left .fade.left{ opacity:1; }
    .shelf__frame.has-overflow.show-right .fade.right{ opacity:1; }

    /* Hover overlay (peek) */
    .peek{
      position:absolute;
      left:0;
      bottom:0;
      width:var(--peekW);
      height:var(--peekH);
      border-radius: 16px;
      overflow:hidden;
      box-shadow: var(--shadow);
      opacity:0;
      transform: translateY(10px) translateX(var(--peekShift, 0px));
      transition: opacity .14s ease, transform .14s ease;
      z-index:50;
      pointer-events:none; /* becomes auto when visible */
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
    }
    .peek::before{
      content:"";
      position:absolute;
      inset:0;
      background: linear-gradient(180deg, rgba(0,0,0,.15) 0%, rgba(0,0,0,.72) 55%, rgba(0,0,0,.85) 100%);
      z-index:0;
    }

    .card:hover .peek,
    .card:focus-within .peek,
    .card.is-open .peek{
      opacity:1;
      transform: translateY(0) translateX(var(--peekShift, 0px));
      pointer-events:auto;
    }

    .peek__content{
      position:relative;
      z-index:2;
      padding: var(--peekPad);
      height:100%;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .peek__title{
      font-size:22px;
      font-weight:800;
      letter-spacing:.2px;
      line-height:1.1;
      margin:0;
    }
    .peek__award{
      color:var(--accent);
      font-weight:800;
      letter-spacing:.2px;
      margin-top:2px;
      font-size:18px;
      line-height:1.1;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .peek__synopsis{
      color:rgba(233,238,243,.95);
      font-size:17px;
      line-height:1.35;
      display:-webkit-box;
      -webkit-box-orient:vertical;
      -webkit-line-clamp:3; /* clamp synopsis to 3 lines */
      overflow:hidden;
    }

    .peek__line{
      font-size:15px;
      line-height:1.25;
      color:rgba(233,238,243,.92);
      display:flex;
      gap:6px;
      align-items:baseline;
      min-width:0;
    }
    .peek__label{
      font-weight:850;
      color:rgba(233,238,243,.92);
      white-space:nowrap;
    }

    .peek__themes{
      display:inline-block;
      min-width:0;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis; /* clamp 1 line */
    }
    .peek__take{
      display:-webkit-box;
      -webkit-box-orient:vertical;
      -webkit-line-clamp:2;   /* clamp 2 lines */
      overflow:hidden;
    }

    /* Pills row */
    .peek__bottom{
      margin-top:auto;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
    }
    .pills{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    .pill{
      font-size:16px;
      padding:8px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.22);
      background: rgba(0,0,0,.18);
      color:rgba(233,238,243,.95);
      line-height:1;
      white-space:nowrap;
    }
    .pill.rating{
      width:38px;
      height:38px;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:0;
      font-weight:900;
      letter-spacing:.2px;
    }

    /* “Expandable” (tooltip) targets */
    .expandable{
      cursor:help;
      position:relative;
    }
    .expandable.is-truncated{
      text-decoration: underline dotted rgba(233,238,243,.45);
      text-underline-offset: 3px;
    }

    /* Global tooltip */
    #ffjTooltip{
      position:fixed;
      z-index:9999;
      max-width:min(520px, calc(100vw - 32px));
      background: rgba(10,12,14,.92);
      color: rgba(233,238,243,.98);
      border:1px solid rgba(255,255,255,.18);
      border-radius: 12px;
      box-shadow: 0 18px 45px rgba(0,0,0,.55);
      padding:10px 12px;
      font-size:14px;         /* smaller than overlay */
      line-height:1.35;
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      display:none;
    }
    #ffjTooltip strong{ color:var(--accent); font-weight:900; }

    /* Responsive */
    @media (max-width: 980px){
      :root{ --edgePad: 18px; --cardW: 360px; --cardH: 170px; --peekW: 430px; --peekH: 240px; }
      .navbtn{ top: 54px; }
    }
    @media (max-width: 640px){
      :root{ --cardW: 320px; --cardH: 160px; --peekW: min(92vw, 420px); --peekH: 250px; }
      .peek__synopsis{ font-size:16px; }
      .peek__award{ font-size:17px; }
      .pill{ font-size:15px; padding:7px 11px; }
      .pill.rating{ width:36px; height:36px; }
    }
  </style>
</head>

<body>
  <header>
    <nav class="topnav" aria-label="Primary">
      <a href="#">Films</a>
      <a href="#">Collections</a>
      <a href="#">About</a>
      <a href="#">Search</a>
    </nav>
  </header>

  <main>

    <!-- NEW ON THE JOURNAL -->
    <section class="shelf" aria-label="New on the Journal">
      <div class="shelf__head">
        <h2 class="shelf__title">New on the Journal</h2>
        <a class="shelf__seeall" href="#">See all</a>
      </div>

      <div class="shelf__frame" data-shelf>
        <button class="navbtn prev" aria-label="Scroll left">‹</button>
        <button class="navbtn next" aria-label="Scroll right">›</button>
        <div class="fade left" aria-hidden="true"></div>
        <div class="fade right" aria-hidden="true"></div>

        <div class="rail" tabindex="0">
          <!-- Flow -->
          <a class="card" href="films/flow/" data-title="Flow">
            <div class="poster"><img src="assets/posters/flow.webp" alt="Flow poster"></div>
            <div class="meta">
              <div class="name">Flow</div>
              <div class="year">2024</div>
            </div>

            <div class="peek" role="dialog" aria-label="Flow details">
              <div class="peek__content">
                <div>
                  <div class="peek__title">Flow</div>
                  <div class="peek__award expandable" data-full="Oscar® winner — Best Animated Feature">Oscar® winner — Best Animated Feature</div>
                </div>

                <div class="peek__synopsis expandable"
                     data-full="Flow tells the story of a lone cat who must learn to collaborate with a mismatched group of other species to survive a catastrophic flood.">
                  Flow tells the story of a lone cat who must learn to collaborate with a mismatched group of other species to survive a catastrophic flood.
                </div>

                <div class="peek__line">
                  <span class="peek__label">Themes:</span>
                  <span class="peek__themes expandable"
                        data-full="Cooperation • impermanence & connection • future of the planet">
                    Cooperation • impermanence & connection • future of the planet
                  </span>
                </div>

                <div class="peek__line">
                  <span class="peek__label">Our take:</span>
                  <span class="peek__take expandable"
                        data-full="A dialogue-free animal odyssey that turns panic into cooperation—quietly devastating">
                    A dialogue-free animal odyssey that turns panic into cooperation—quietly devastating
                  </span>
                </div>

                <div class="peek__bottom">
                  <div class="pills">
                    <span class="pill">IMDb 8.4/10</span>
                    <span class="pill">2024</span>
                    <span class="pill">1h 25m</span>
                    <span class="pill rating">U</span>
                  </div>
                </div>
              </div>
            </div>
          </a>

          <!-- Zootropolis -->
          <a class="card" href="films/zootropolis/" data-title="Zootropolis">
            <div class="poster"><img src="assets/posters/zootropolis.webp" alt="Zootropolis poster"></div>
            <div class="meta">
              <div class="name">Zootropolis</div>
              <div class="year">2016</div>
            </div>

            <div class="peek" role="dialog" aria-label="Zootropolis details">
              <div class="peek__content">
                <div>
                  <div class="peek__title">Zootropolis</div>
                  <div class="peek__award expandable" data-full="Oscar® winner — Best Animated Feature">Oscar® winner — Best Animated Feature</div>
                </div>

                <div class="peek__synopsis expandable"
                     data-full="In a world of anthropomorphic animals, Judy the rabbit becomes the first rabbit police officer in the city of Zootropolis, where prejudices against “predator” animals are in danger of resurfacing.">
                  In a world of anthropomorphic animals, Judy the rabbit becomes the first rabbit police officer in the city of Zootropolis, where prejudices against “predator” animals are in danger of resurfacing.
                </div>

                <div class="peek__line">
                  <span class="peek__label">Themes:</span>
                  <span class="peek__themes expandable"
                        data-full="Big dreams & perseverance • doing the right thing (public service) • learning from mistakes • stereotypes & prejudice • fear-mongering & misinformation">
                    Big dreams & perseverance • doing the right thing (public service) • learning from mistakes • stereotypes & prejudice • fear-mongering & misinformation
                  </span>
                </div>

                <div class="peek__line">
                  <span class="peek__label">Our take:</span>
                  <span class="peek__take expandable"
                        data-full="Funny and sharp; great for most 6+ with a parent">
                    Funny and sharp; great for most 6+ with a parent
                  </span>
                </div>

                <div class="peek__bottom">
                  <div class="pills">
                    <span class="pill">IMDb 8.0/10</span>
                    <span class="pill">2016</span>
                    <span class="pill">1h 48m</span>
                    <span class="pill rating expandable" data-full="PG (mild threat)">PG</span>
                  </div>
                </div>
              </div>
            </div>
          </a>

          <!-- Spirited Away -->
          <a class="card" href="films/spirited-away/" data-title="Spirited Away">
            <div class="poster"><img src="assets/posters/spirited-away.webp" alt="Spirited Away poster"></div>
            <div class="meta">
              <div class="name">Spirited Away</div>
              <div class="year">2001</div>
            </div>

            <div class="peek" role="dialog" aria-label="Spirited Away details">
              <div class="peek__content">
                <div>
                  <div class="peek__title">Spirited Away</div>
                  <div class="peek__award expandable" data-full="Oscar® winner — Best Animated Feature">Oscar® winner — Best Animated Feature</div>
                </div>

                <div class="peek__synopsis expandable"
                     data-full="A 10-year-old girl slips into a spirit bathhouse where her parents are turned into pigs—and must find the courage to work, survive, and bring them home.">
                  A 10-year-old girl slips into a spirit bathhouse where her parents are turned into pigs—and must find the courage to work, survive, and bring them home.
                </div>

                <div class="peek__line">
                  <span class="peek__label">Themes:</span>
                  <span class="peek__themes expandable"
                        data-full="Growing up & resilience • identity • greed & consumerism • courage under pressure • compassion • spirits/nature & respect">
                    Growing up & resilience • identity • greed & consumerism • courage under pressure • compassion • spirits/nature & respect
                  </span>
                </div>

                <div class="peek__line">
                  <span class="peek__label">Our take:</span>
                  <span class="peek__take expandable"
                        data-full="A gorgeous, unsettling coming-of-age dream—brilliant for talking about greed, identity, and growing up.">
                    A gorgeous, unsettling coming-of-age dream—brilliant for talking about greed, identity, and growing up.
                  </span>
                </div>

                <div class="peek__bottom">
                  <div class="pills">
                    <span class="pill">IMDb 9.0/10</span>
                    <span class="pill">2001</span>
                    <span class="pill">2h 4m</span>
                    <span class="pill rating expandable" data-full="PG (mild threat & scary scenes; brief injury detail)">PG</span>
                  </div>
                </div>
              </div>
            </div>
          </a>

        </div>
      </div>
    </section>

    <!-- ANIMATION CLASSICS -->
    <section class="shelf" aria-label="Animation Classics">
      <div class="shelf__head">
        <h2 class="shelf__title">Animation Classics</h2>
        <a class="shelf__seeall" href="#">See all</a>
      </div>

      <div class="shelf__frame" data-shelf>
        <button class="navbtn prev" aria-label="Scroll left">‹</button>
        <button class="navbtn next" aria-label="Scroll right">›</button>
        <div class="fade left" aria-hidden="true"></div>
        <div class="fade right" aria-hidden="true"></div>

        <div class="rail" tabindex="0">
          <!-- Zootropolis -->
          <a class="card" href="films/zootropolis/" data-title="Zootropolis">
            <div class="poster"><img src="assets/posters/zootropolis.webp" alt="Zootropolis poster"></div>
            <div class="meta"><div class="name">Zootropolis</div><div class="year">2016</div></div>
            <!-- same peek (kept simple: duplicated for now) -->
            <div class="peek" role="dialog" aria-label="Zootropolis details">
              <div class="peek__content">
                <div>
                  <div class="peek__title">Zootropolis</div>
                  <div class="peek__award expandable" data-full="Oscar® winner — Best Animated Feature">Oscar® winner — Best Animated Feature</div>
                </div>
                <div class="peek__synopsis expandable"
                     data-full="In a world of anthropomorphic animals, Judy the rabbit becomes the first rabbit police officer in the city of Zootropolis, where prejudices against “predator” animals are in danger of resurfacing.">
                  In a world of anthropomorphic animals, Judy the rabbit becomes the first rabbit police officer in the city of Zootropolis, where prejudices against “predator” animals are in danger of resurfacing.
                </div>
                <div class="peek__line"><span class="peek__label">Themes:</span>
                  <span class="peek__themes expandable"
                        data-full="Big dreams & perseverance • doing the right thing (public service) • learning from mistakes • stereotypes & prejudice • fear-mongering & misinformation">
                    Big dreams & perseverance • doing the right thing (public service) • learning from mistakes • stereotypes & prejudice • fear-mongering & misinformation
                  </span>
                </div>
                <div class="peek__line"><span class="peek__label">Our take:</span>
                  <span class="peek__take expandable" data-full="Funny and sharp; great for most 6+ with a parent">
                    Funny and sharp; great for most 6+ with a parent
                  </span>
                </div>
                <div class="peek__bottom"><div class="pills">
                  <span class="pill">IMDb 8.0/10</span><span class="pill">2016</span><span class="pill">1h 48m</span>
                  <span class="pill rating expandable" data-full="PG (mild threat)">PG</span>
                </div></div>
              </div>
            </div>
          </a>

          <!-- Spirited Away -->
          <a class="card" href="films/spirited-away/" data-title="Spirited Away">
            <div class="poster"><img src="assets/posters/spirited-away.webp" alt="Spirited Away poster"></div>
            <div class="meta"><div class="name">Spirited Away</div><div class="year">2001</div></div>
            <div class="peek" role="dialog" aria-label="Spirited Away details">
              <div class="peek__content">
                <div>
                  <div class="peek__title">Spirited Away</div>
                  <div class="peek__award expandable" data-full="Oscar® winner — Best Animated Feature">Oscar® winner — Best Animated Feature</div>
                </div>
                <div class="peek__synopsis expandable"
                     data-full="A 10-year-old girl slips into a spirit bathhouse where her parents are turned into pigs—and must find the courage to work, survive, and bring them home.">
                  A 10-year-old girl slips into a spirit bathhouse where her parents are turned into pigs—and must find the courage to work, survive, and bring them home.
                </div>
                <div class="peek__line"><span class="peek__label">Themes:</span>
                  <span class="peek__themes expandable"
                        data-full="Growing up & resilience • identity • greed & consumerism • courage under pressure • compassion • spirits/nature & respect">
                    Growing up & resilience • identity • greed & consumerism • courage under pressure • compassion • spirits/nature & respect
                  </span>
                </div>
                <div class="peek__line"><span class="peek__label">Our take:</span>
                  <span class="peek__take expandable"
                        data-full="A gorgeous, unsettling coming-of-age dream—brilliant for talking about greed, identity, and growing up.">
                    A gorgeous, unsettling coming-of-age dream—brilliant for talking about greed, identity, and growing up.
                  </span>
                </div>
                <div class="peek__bottom"><div class="pills">
                  <span class="pill">IMDb 9.0/10</span><span class="pill">2001</span><span class="pill">2h 4m</span>
                  <span class="pill rating expandable" data-full="PG (mild threat & scary scenes; brief injury detail)">PG</span>
                </div></div>
              </div>
            </div>
          </a>

          <!-- Totoro -->
          <a class="card" href="films/my-neighbor-totoro/" data-title="My Neighbor Totoro">
            <div class="poster"><img src="assets/posters/my-neighbor-totoro.webp" alt="My Neighbor Totoro poster"></div>
            <div class="meta"><div class="name">My Neighbor Totoro</div><div class="year">1988</div></div>

            <div class="peek" role="dialog" aria-label="My Neighbor Totoro details">
              <div class="peek__content">
                <div>
                  <div class="peek__title">My Neighbor Totoro</div>
                  <div class="peek__award expandable" data-full="(Animation classic)">Animation classic</div>
                </div>
                <div class="peek__synopsis expandable"
                     data-full="Two sisters move to the countryside while their mother is unwell — and discover the nearby woods are alive with shy, gentle spirits. A small family story that turns worry into wonder, with a few tense moments that resolve warmly.">
                  Two sisters move to the countryside while their mother is unwell — and discover the nearby woods are alive with shy, gentle spirits. A small family story that turns worry into wonder, with a few tense moments that resolve warmly.
                </div>
                <div class="peek__line"><span class="peek__label">Themes:</span>
                  <span class="peek__themes expandable"
                        data-full="Sisterhood • moving home • nature as comfort • imagination & wonder • family illness (gentle) • kindness to the unknown">
                    Sisterhood • moving home • nature as comfort • imagination & wonder • family illness (gentle) • kindness to the unknown
                  </span>
                </div>
                <div class="peek__line"><span class="peek__label">Our take:</span>
                  <span class="peek__take expandable"
                        data-full="A soft, restorative film that takes children’s worries seriously — then answers them with wonder.">
                    A soft, restorative film that takes children’s worries seriously — then answers them with wonder.
                  </span>
                </div>
                <div class="peek__bottom"><div class="pills">
                  <span class="pill">IMDb 8.1/10</span><span class="pill">1988</span><span class="pill">1h 26m</span>
                  <span class="pill rating expandable" data-full="U (very mild threat; briefly missing child)">U</span>
                </div></div>
              </div>
            </div>
          </a>

        </div>
      </div>
    </section>

    <!-- ANIMALS AS ANIMALS -->
    <section class="shelf" aria-label="Animals as Animals">
      <div class="shelf__head">
        <h2 class="shelf__title">Animals as Animals</h2>
        <a class="shelf__seeall" href="#">See all</a>
      </div>

      <div class="shelf__frame" data-shelf>
        <button class="navbtn prev" aria-label="Scroll left">‹</button>
        <button class="navbtn next" aria-label="Scroll right">›</button>
        <div class="fade left" aria-hidden="true"></div>
        <div class="fade right" aria-hidden="true"></div>

        <div class="rail" tabindex="0">
          <!-- Flow -->
          <a class="card" href="films/flow/" data-title="Flow">
            <div class="poster"><img src="assets/posters/flow.webp" alt="Flow poster"></div>
            <div class="meta"><div class="name">Flow</div><div class="year">2024</div></div>
            <div class="peek" role="dialog" aria-label="Flow details">
              <div class="peek__content">
                <div><div class="peek__title">Flow</div>
                  <div class="peek__award expandable" data-full="Oscar® winner — Best Animated Feature">Oscar® winner — Best Animated Feature</div>
                </div>
                <div class="peek__synopsis expandable"
                     data-full="Flow tells the story of a lone cat who must learn to collaborate with a mismatched group of other species to survive a catastrophic flood.">
                  Flow tells the story of a lone cat who must learn to collaborate with a mismatched group of other species to survive a catastrophic flood.
                </div>
                <div class="peek__line"><span class="peek__label">Themes:</span>
                  <span class="peek__themes expandable"
                        data-full="Cooperation • impermanence & connection • future of the planet">
                    Cooperation • impermanence & connection • future of the planet
                  </span>
                </div>
                <div class="peek__line"><span class="peek__label">Our take:</span>
                  <span class="peek__take expandable"
                        data-full="A dialogue-free animal odyssey that turns panic into cooperation—quietly devastating">
                    A dialogue-free animal odyssey that turns panic into cooperation—quietly devastating
                  </span>
                </div>
                <div class="peek__bottom"><div class="pills">
                  <span class="pill">IMDb 8.4/10</span><span class="pill">2024</span><span class="pill">1h 25m</span><span class="pill rating">U</span>
                </div></div>
              </div>
            </div>
          </a>
        </div>
      </div>
    </section>

    <!-- ROBOTS WITH HEARTS -->
    <section class="shelf" aria-label="Robots with Hearts">
      <div class="shelf__head">
        <h2 class="shelf__title">Robots with Hearts</h2>
        <a class="shelf__seeall" href="#">See all</a>
      </div>

      <div class="shelf__frame" data-shelf>
        <button class="navbtn prev" aria-label="Scroll left">‹</button>
        <button class="navbtn next" aria-label="Scroll right">›</button>
        <div class="fade left" aria-hidden="true"></div>
        <div class="fade right" aria-hidden="true"></div>

        <div class="rail" tabindex="0">
          <!-- The Iron Giant -->
          <a class="card" href="films/the-iron-giant/" data-title="The Iron Giant">
            <div class="poster"><img src="assets/posters/the-iron-giant.webp" alt="The Iron Giant poster"></div>
            <div class="meta"><div class="name">The Iron Giant</div><div class="year">1999</div></div>

            <div class="peek" role="dialog" aria-label="The Iron Giant details">
              <div class="peek__content">
                <div><div class="peek__title">The Iron Giant</div>
                  <div class="peek__award expandable" data-full="BAFTA — Children’s">BAFTA — Children’s</div>
                </div>
                <div class="peek__synopsis expandable"
                     data-full="A young boy finds a huge metal robot in the woods near his home and rescues the creature from electrocution. The pair form an unlikely friendship, which is put to the test when a suspicious FBI agent learns of the giant's existence.">
                  A young boy finds a huge metal robot in the woods near his home and rescues the creature from electrocution. The pair form an unlikely friendship, which is put to the test when a suspicious FBI agent learns of the giant's existence.
                </div>
                <div class="peek__line"><span class="peek__label">Themes:</span>
                  <span class="peek__themes expandable"
                        data-full="Friendship & trust • choosing who you become • Cold War fear of the “other” • anti-war • courage & self-sacrifice">
                    Friendship & trust • choosing who you become • Cold War fear of the “other” • anti-war • courage & self-sacrifice
                  </span>
                </div>
                <div class="peek__line"><span class="peek__label">Our take:</span>
                  <span class="peek__take expandable"
                        data-full="A moving parable about a weapon that refuses to be one. Simple, human, and deeply felt.">
                    A moving parable about a weapon that refuses to be one. Simple, human, and deeply felt.
                  </span>
                </div>
                <div class="peek__bottom"><div class="pills">
                  <span class="pill">IMDb 8.1/10</span><span class="pill">1999</span><span class="pill">1h 26m</span><span class="pill rating">U</span>
                </div></div>
              </div>
            </div>
          </a>

          <!-- WALL·E -->
          <a class="card" href="films/wall-e/" data-title="WALL·E">
            <div class="poster"><img src="assets/posters/wall-e.webp" alt="WALL·E poster"></div>
            <div class="meta"><div class="name">WALL·E</div><div class="year">2008</div></div>

            <div class="peek" role="dialog" aria-label="WALL·E details">
              <div class="peek__content">
                <div><div class="peek__title">WALL·E</div>
                  <div class="peek__award expandable" data-full="BAFTA — Best Animated Film">BAFTA — Best Animated Film</div>
                </div>
                <div class="peek__synopsis expandable"
                     data-full="Alone on an abandoned Earth, a small waste-collecting robot keeps going — until a sleek new robot arrives and changes his world. A near-silent love story that grows into a funny, hopeful sci-fi adventure about what humans leave behind.">
                  Alone on an abandoned Earth, a small waste-collecting robot keeps going — until a sleek new robot arrives and changes his world. A near-silent love story that grows into a funny, hopeful sci-fi adventure about what humans leave behind.
                </div>
                <div class="peek__line"><span class="peek__label">Themes:</span>
                  <span class="peek__themes expandable"
                        data-full="Love & connection • loneliness • protecting nature • consumerism & waste • humans + technology • rebuilding a future">
                    Love & connection • loneliness • protecting nature • consumerism & waste • humans + technology • rebuilding a future
                  </span>
                </div>
                <div class="peek__line"><span class="peek__label">Our take:</span>
                  <span class="peek__take expandable"
                        data-full="One of the best “first sci-fi” films for kids: simple to follow, rich to talk about afterwards.">
                    One of the best “first sci-fi” films for kids: simple to follow, rich to talk about afterwards.
                  </span>
                </div>
                <div class="peek__bottom"><div class="pills">
                  <span class="pill">IMDb 8.4/10</span><span class="pill">2008</span><span class="pill">1h 38m</span>
                  <span class="pill rating expandable" data-full="U (very mild threat/violence)">U</span>
                </div></div>
              </div>
            </div>
          </a>

        </div>
      </div>
    </section>

    <!-- GROWN-UP CLASSICS KIDS CAN JOIN -->
    <section class="shelf" aria-label="Grown-up classics kids can join">
      <div class="shelf__head">
        <h2 class="shelf__title">Grown-up classics kids can join</h2>
        <a class="shelf__seeall" href="#">See all</a>
      </div>

      <div class="shelf__frame" data-shelf>
        <button class="navbtn prev" aria-label="Scroll left">‹</button>
        <button class="navbtn next" aria-label="Scroll right">›</button>
        <div class="fade left" aria-hidden="true"></div>
        <div class="fade right" aria-hidden="true"></div>

        <div class="rail" tabindex="0">
          <!-- La La Land -->
          <a class="card" href="films/la-la-land/" data-title="La La Land">
            <div class="poster"><img src="assets/posters/la-la-land.webp" alt="La La Land poster"></div>
            <div class="meta"><div class="name">La La Land</div><div class="year">2016</div></div>

            <div class="peek" role="dialog" aria-label="La La Land details">
              <div class="peek__content">
                <div><div class="peek__title">La La Land</div>
                  <div class="peek__award expandable" data-full="BAFTA — Best Film; Oscar — Best Directing">BAFTA — Best Film; Oscar — Best Directing</div>
                </div>
                <div class="peek__synopsis expandable"
                     data-full="In Los Angeles, a jazz pianist and an aspiring actress fall in love while chasing careers that don’t always fit neatly together. A romantic, music-led story that’s mostly light — with one moment of strong language that pushes the rating up.">
                  In Los Angeles, a jazz pianist and an aspiring actress fall in love while chasing careers that don’t always fit neatly together. A romantic, music-led story that’s mostly light — with one moment of strong language that pushes the rating up.
                </div>
                <div class="peek__line"><span class="peek__label">Themes:</span>
                  <span class="peek__themes expandable"
                        data-full="Dreams vs relationships • ambition & compromise • creativity • “what if?” paths • persistence after setbacks • the price of success">
                    Dreams vs relationships • ambition & compromise • creativity • “what if?” paths • persistence after setbacks • the price of success
                  </span>
                </div>
                <div class="peek__line"><span class="peek__label">Our take:</span>
                  <span class="peek__take expandable"
                        data-full="A joyful musical with bittersweet honesty: sometimes growing up means choosing — and letting something go.">
                    A joyful musical with bittersweet honesty: sometimes growing up means choosing — and letting something go.
                  </span>
                </div>
                <div class="peek__bottom"><div class="pills">
                  <span class="pill">IMDb 8.0/10</span><span class="pill">2016</span><span class="pill">2h 8m</span>
                  <span class="pill rating expandable" data-full="12A">12A</span>
                </div></div>
              </div>
            </div>
          </a>

          <!-- It's a Wonderful Life -->
          <a class="card" href="films/its-a-wonderful-life/" data-title="It’s a Wonderful Life">
            <div class="poster"><img src="assets/posters/its-a-wonderful-life.webp" alt="It’s a Wonderful Life poster"></div>
            <div class="meta"><div class="name">It’s a Wonderful Life</div><div class="year">1946</div></div>

            <div class="peek" role="dialog" aria-label="It’s a Wonderful Life details">
              <div class="peek__content">
                <div><div class="peek__title">It’s a Wonderful Life</div>
                  <div class="peek__award expandable" data-full="Oscar — Best Picture">Oscar — Best Picture</div>
                </div>
                <div class="peek__synopsis expandable"
                     data-full="On a desperate night, a man who feels he’s failed is shown how many lives he’s changed — and what the world would look like without him. It starts dark, but lands warm, funny, and deeply life-affirming.">
                  On a desperate night, a man who feels he’s failed is shown how many lives he’s changed — and what the world would look like without him. It starts dark, but lands warm, funny, and deeply life-affirming.
                </div>
                <div class="peek__line"><span class="peek__label">Themes:</span>
                  <span class="peek__themes expandable"
                        data-full="Self-worth • kindness & community • money vs values • mental health (handled with hope) • gratitude • the ripple effect of small choices">
                    Self-worth • kindness & community • money vs values • mental health (handled with hope) • gratitude • the ripple effect of small choices
                  </span>
                </div>
                <div class="peek__line"><span class="peek__label">Our take:</span>
                  <span class="peek__take expandable"
                        data-full="Tough at the start — but one of the best films for talking about kindness, money, and what “success” really means.">
                    Tough at the start — but one of the best films for talking about kindness, money, and what “success” really means.
                  </span>
                </div>
                <div class="peek__bottom"><div class="pills">
                  <span class="pill">IMDb 8.6/10</span><span class="pill">1946</span><span class="pill">2h 10m</span>
                  <span class="pill rating expandable" data-full="U (suicide theme is central but treated sensitively with a reassuring outcome)">U</span>
                </div></div>
              </div>
            </div>
          </a>

        </div>
      </div>
    </section>

    <!-- Tooltip element -->
    <div id="ffjTooltip" role="tooltip" aria-hidden="true"></div>

  </main>

  <script>
    (function(){
      const tooltip = document.getElementById('ffjTooltip');
      let tooltipTarget = null;
      let hideTimer = null;

      function isTruncated(el){
        // Works for single-line ellipsis and multi-line line-clamp.
        return (el.scrollWidth - el.clientWidth) > 1 || (el.scrollHeight - el.clientHeight) > 1;
      }

      function showTooltip(target, htmlText){
        clearTimeout(hideTimer);
        tooltipTarget = target;
        tooltip.textContent = htmlText;

        // Position near target, keep inside viewport.
        const r = target.getBoundingClientRect();
        tooltip.style.display = 'block';
        tooltip.setAttribute('aria-hidden','false');

        const pad = 12;
        const tw = tooltip.offsetWidth;
        const th = tooltip.offsetHeight;

        let x = Math.min(Math.max(r.left, pad), window.innerWidth - tw - pad);
        let y = r.bottom + 8;

        if (y + th > window.innerHeight - pad){
          y = r.top - th - 8;
        }
        y = Math.max(pad, y);

        tooltip.style.left = x + 'px';
        tooltip.style.top  = y + 'px';
      }

      function hideTooltipSoon(){
        clearTimeout(hideTimer);
        hideTimer = setTimeout(()=> {
          tooltip.style.display = 'none';
          tooltip.setAttribute('aria-hidden','true');
          tooltipTarget = null;
        }, 120);
      }

      tooltip.addEventListener('mouseenter', ()=> clearTimeout(hideTimer));
      tooltip.addEventListener('mouseleave', hideTooltipSoon);

      window.addEventListener('scroll', () => {
        if (tooltip.style.display === 'block') hideTooltipSoon();
      }, {passive:true});

      window.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && tooltip.style.display === 'block'){
          tooltip.style.display = 'none';
          tooltip.setAttribute('aria-hidden','true');
          tooltipTarget = null;
        }
      });

      // Mark truncation + bind tooltip behaviour
      function prepareExpandable(root){
        root.querySelectorAll('.expandable').forEach(el=>{
          // ensure truncation class is accurate
          const truncated = isTruncated(el);
          el.classList.toggle('is-truncated', truncated);

          // hover/focus tooltip for truncated OR explicit tooltip content
          const full = el.getAttribute('data-full');
          if (!full) return;

          // Desktop hover
          el.addEventListener('mouseenter', () => {
            // only show if truncated OR it’s a rating pill / award line (explicit)
            if (isTruncated(el) || el.classList.contains('rating') || el.classList.contains('peek__award')){
              showTooltip(el, full);
            }
          });

          el.addEventListener('mouseleave', () => {
            if (tooltipTarget === el) hideTooltipSoon();
          });

          // Keyboard focus
          el.setAttribute('tabindex','0');
          el.addEventListener('focus', () => {
            if (isTruncated(el) || el.classList.contains('rating') || el.classList.contains('peek__award')){
              showTooltip(el, full);
            }
          });
          el.addEventListener('blur', () => {
            if (tooltipTarget === el) hideTooltipSoon();
          });

          // Mobile / tap
          el.addEventListener('click', (ev) => {
            // don’t navigate when tapping inside overlay details
            ev.preventDefault();
            ev.stopPropagation();

            const canShow = isTruncated(el) || el.classList.contains('rating') || el.classList.contains('peek__award');
            if (!canShow) return;

            if (tooltipTarget === el && tooltip.style.display === 'block'){
              tooltip.style.display = 'none';
              tooltip.setAttribute('aria-hidden','true');
              tooltipTarget = null;
            } else {
              showTooltip(el, full);
            }
          }, {passive:false});
        });
      }

      // Fix peek clipping on the right/left edge by shifting overlay inside viewport
      function positionPeek(card){
        const peek = card.querySelector('.peek');
        if (!peek) return;
        peek.style.setProperty('--peekShift', '0px');

        requestAnimationFrame(() => {
          const r = peek.getBoundingClientRect();
          const pad = 14;
          let shift = 0;

          if (r.right > window.innerWidth - pad) shift = (window.innerWidth - pad) - r.right;
          if (r.left + shift < pad) shift += pad - (r.left + shift);

          peek.style.setProperty('--peekShift', shift + 'px');
          prepareExpandable(peek);
        });
      }

      // Shelves: arrows + fades + overflow detection
      function setupShelf(frame){
        const rail = frame.querySelector('.rail');
        const prev = frame.querySelector('.navbtn.prev');
        const next = frame.querySelector('.navbtn.next');

        function updateOverflow(){
          const hasOverflow = rail.scrollWidth > rail.clientWidth + 4;
          frame.classList.toggle('has-overflow', hasOverflow);
          updateFades();
        }

        function updateFades(){
          const left = rail.scrollLeft > 6;
          const right = rail.scrollLeft < (rail.scrollWidth - rail.clientWidth - 6);
          frame.classList.toggle('show-left', left);
          frame.classList.toggle('show-right', right);
        }

        prev.addEventListener('click', () => rail.scrollBy({left: -Math.round(rail.clientWidth * 0.92), behavior:'smooth'}));
        next.addEventListener('click', () => rail.scrollBy({left:  Math.round(rail.clientWidth * 0.92), behavior:'smooth'}));

        rail.addEventListener('scroll', updateFades, {passive:true});
        window.addEventListener('resize', updateOverflow, {passive:true});

        // IMPORTANT: keep vertical page scroll working.
        // Only translate wheel to horizontal scroll when Shift is held.
        rail.addEventListener('wheel', (e) => {
          if (e.shiftKey){
            rail.scrollLeft += e.deltaY;
            e.preventDefault();
          }
        }, {passive:false});

        updateOverflow();
      }

      // Cards: hover/focus/tap behaviour
      function setupCards(){
        const cards = document.querySelectorAll('.card');

        function closeAll(){
          cards.forEach(c => c.classList.remove('is-open','is-sticky'));
          tooltip.style.display = 'none';
          tooltip.setAttribute('aria-hidden','true');
          tooltipTarget = null;
        }

        cards.forEach(card => {
          card.addEventListener('mouseenter', () => {
            if (!card.classList.contains('is-sticky')){
              card.classList.add('is-open');
              positionPeek(card);
            }
          });

          card.addEventListener('mouseleave', () => {
            if (!card.classList.contains('is-sticky')){
              card.classList.remove('is-open');
            }
          });

          card.addEventListener('focusin', () => {
            card.classList.add('is-open');
            positionPeek(card);
          });

          card.addEventListener('focusout', () => {
            if (!card.classList.contains('is-sticky')){
              card.classList.remove('is-open');
            }
          });

          // Mobile: first tap opens overlay, second tap navigates
          card.addEventListener('click', (e) => {
            const isSticky = card.classList.contains('is-sticky');
            const isOpen = card.classList.contains('is-open');

            if (!isOpen || !isSticky){
              e.preventDefault();
              closeAll();
              card.classList.add('is-open','is-sticky');
              positionPeek(card);
            }
          });
        });

        document.addEventListener('click', (e) => {
          // click outside closes sticky overlays
          const insideCard = e.target.closest('.card');
          const insideTooltip = e.target.closest('#ffjTooltip');
          if (!insideCard && !insideTooltip) closeAll();
        }, {passive:true});
      }

      // Init
      document.querySelectorAll('[data-shelf]').forEach(setupShelf);
      setupCards();
    })();
  </script>
</body>
</html>
